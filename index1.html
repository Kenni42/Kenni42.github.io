<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Line Chart from Google Sheets</title>

    <!-- Load Chart.js library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Load the Google Sheets API library -->
    <script src="https://apis.google.com/js/api.js"></script>

    <script>
        // Replace with your API key and Google Sheet ID
        const apiKey = 'AIzaSyAVkGRNEasbWyomIXK6m6WvF07uL-y-gbM';
        const sheetId = '13MQgK_-YBdYTW7p4DESjh0tYaCdBJp-brHIk3qpE6bo';

        // Function to load the Google Sheets API
        function initClient() {
            gapi.client.init({
                'apiKey': apiKey,
                'discoveryDocs': ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
            }).then(function() {
                // Call the function to fetch data and update the chart
                getDataAndUpdateChart();
            });
        }

        // Function to fetch data from Google Sheet and update the chart
        function getDataAndUpdateChart() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: sheetId,
                range: 'Ark1!B3:C',  // Specify the sheet name and columns
            }).then(function(response) {
                const values = response.result.values;

                if (values && values.length > 0) {
                    // Assuming the first column contains x values and the second column contains y values
                    const xData = values.map(row => parseFloat(row[0]));
                    const yData = values.map(row => parseFloat(row[1]));

                    // Update the chart with the fetched data
                    updateChart(xData, yData);
                } else {
                    console.error('No data found in the specified range.');
                }
            });
        }

        // Function to update the line chart
    function updateChart(xData, yData) {
    const ctx = document.getElementById('myChart').getContext('2d');

    // Create the line chart
    const myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: xData,
            datasets: [{
                label: 'My Data',
                data: yData,
                borderColor: 'rgb(75, 192, 192)',
                borderWidth: 2,
                fill: false,
            }],
        },
        options: {
            scales: {
                x: {
                    type: 'linear',  // Use 'linear' for numeric x-axis
                    position: 'bottom',
                },
                y: {
                    type: 'linear',  // Use 'linear' for numeric y-axis
                    position: 'left',
                },
            },
        },
    });
}
        // Load the Google Sheets API and initialize the client
        gapi.load('client', initClient);
    </script>
</head>
<body>
    <!-- Chart canvas -->
    <canvas id="myChart" width="400" height="200"></canvas>
</body>
</html>
